import{s as z,p as T,b as t,c as $,e as ae,f as fe,h as N,i as Se,j as _,k as y,l as u,m as d,n as Ie,q as M,u as A,v as Le,x as me,y as ee,z as te,A as q,B as X,C as oe,D as ce,E as w,F as ie,G as se,H as Pe,I as re,J as Y,K as ne,L as Te,M as Ne}from"./svelte-CfnTyYTQ.js";import{c as Oe,a as ke}from"./melt-fZhddGwx.js";import{m as he}from"./meilisearch-FfvDoEWw.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function i(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(e){if(e.ep)return;e.ep=!0;const s=i(e);fetch(e.href,s)}})();function Ce(p,a,{signal:i,edges:n}={}){let e,s=null;const r=n!=null&&n.includes("leading"),b=n==null||n.includes("trailing"),v=()=>{s!==null&&(p.apply(e,s),e=void 0,s=null)},O=()=>{b&&v(),k()};let f=null;const V=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,O()},a)},U=()=>{f!==null&&(clearTimeout(f),f=null)},k=()=>{U(),e=void 0,s=null},F=()=>{U(),v()},K=function(...o){if(i?.aborted)return;e=this,s=o;const h=f==null;V(),r&&h&&v()};return K.schedule=V,K.cancel=k,K.flush=F,i?.addEventListener("abort",k,{once:!0}),K}const ge=(p,a,i={})=>{if(!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let n,e,s=[];return function(...r){return new Promise(b=>{const v=i.before&&!e;clearTimeout(e),e=setTimeout(()=>{e=null;const O=i.before?n:p.apply(this,r);for(b of s)b(O);s=[]},a),v?(n=p.apply(this,r),b(n)):s.push(b)})}};ge.promise=p=>{let a;return async function(...i){if(a)return a;try{return a=p.apply(this,i),await a}finally{a=void 0}}};class Ee{#e=z(T(new URLSearchParams(window.location.search).get("api_key")??localStorage.getItem("meili_api_key")));get apiKey(){return t(this.#e)}set apiKey(a){$(this.#e,T(a))}#t=z(T(new URLSearchParams(window.location.search).get("host")??localStorage.getItem("meili_host")??`${window.location.protocol}//${window.location.hostname}:7700`));get host(){return t(this.#t)}set host(a){$(this.#t,T(a))}#a=ae(()=>new he.MeiliSearch({host:this.host,apiKey:this.apiKey??void 0,clientAgents:["mini-meili v?"]}));get client(){return t(this.#a)}}const m=new Ee;var Me=y('<div><div class="i-lucide:search mr-1 p-3"></div> <input></div>');function le(p,a){let i=fe(a,"value",15,""),n=Le(a,["$$slots","$$events","$$legacy","value","className"]);var e=Me(),s=u(d(e),2);let r;N(()=>{Ie(e,a.className),M(e,"flex",!0),M(e,"items-center",!0),M(e,"b-b-solid",!0),M(e,"b-b-2",!0),M(e,"b-red-4",!0),M(e,"bg-#151515",!0),M(e,"px-2",!0),r=A(s,r,{id:"search",...n,class:"py-2"})}),Se(s,i),_(p,e)}var Ae=y('<div class="i-lucide:loader h-5 w-5 animate-spin"></div>'),Ve=y("<button></button>"),Ue=y('<div><div></div> <div><div class="flex items-center gap-2"><h2>Config</h2> <!> <!></div> <label class="flex flex-col">MeiliSearch API Key: <!></label> <label class="mt-2 flex flex-col">MeiliSearch host: <!></label></div></div>'),je=y('<button><span class="i-lucide:cog"></span> Config</button> <!>',1);function qe(p,a){ce(a,!0);const i=me(),n=()=>w(V,"$trigger",i),e=()=>w(U,"$portalled",i),s=()=>w(k,"$overlay",i),r=()=>w(F,"$content",i),b=()=>w(K,"$title",i),v=()=>w(o,"$close",i),O=()=>w(h,"$open",i),f=l=>{try{return new URL(l),!0}catch{return!1}},{elements:{trigger:V,portalled:U,overlay:k,content:F,title:K,close:o},states:{open:h}}=Oe({defaultOpen:m.apiKey==null,role:m.apiKey==null?"alertdialog":"dialog",escapeBehavior:m.apiKey==null?"ignore":"close",closeOnOutsideClick:m.apiKey!=null});let S=z(!1),C=z(T(m.apiKey??"")),E=z(T(m.host));const Z=ge(async()=>{try{const l=new he.MeiliSearch({host:t(E),apiKey:t(C).length>0?t(C):void 0});return await Promise.all([l.getIndexes(),l.getStats(),l.getVersion()]),!0}catch{return!1}},350);ee(()=>{if(t(E).length<3||!f(t(E)))return;const l=t(C);$(S,!0),Z().then(P=>{$(S,!1),P&&(m.host=t(E),m.apiKey=t(C),localStorage.setItem("meili_host",m.host),m.apiKey!=null&&localStorage.setItem("meili_api_key",m.apiKey),l==null&&h.set(!1))})});var g=je(),I=te(g);let R;q(I,l=>n().action?.(l));var L=u(I,2);{var x=l=>{var P=Ue();let H;var j=d(P);let B;q(j,c=>s().action?.(c));var D=u(j,2);let W;var Q=d(D),G=d(Q);let ue;q(G,c=>b().action?.(c));var de=u(G,2);{var be=c=>{var J=Ae();ie(3,J,()=>se),_(c,J)};X(de,c=>{t(S)&&c(be)})}var _e=u(de,2);{var ye=c=>{var J=Ve();let ve;q(J,Ke=>v().action?.(Ke)),N(()=>ve=A(J,ve,{...v(),"aria-label":"Close config dialog",class:"i-lucide:x ml-auto cursor-pointer p-3"})),ie(3,J,()=>se),_(c,J)};X(_e,c=>{m.apiKey!=null&&c(ye)})}var pe=u(Q,2),xe=u(d(pe));le(xe,{id:"apiKey",className:"mt-1",get value(){return t(C)},set value(c){$(C,T(c))}});var we=u(pe,2),$e=u(d(we));le($e,{id:"host",className:"mt-1",get value(){return t(E)},set value(c){$(E,T(c))}}),q(D,c=>r().action?.(c)),q(P,c=>e().action?.(c)),N(()=>{H=A(P,H,{...e()}),B=A(j,B,{...s(),class:"z-100 fixed inset-0 bg-black/50"}),W=A(D,W,{...r(),class:"z-101 left-50% top-50% -translate-x-50% -translate-y-50% bg-#111 rd-xl fixed p-5 shadow-lg shadow-black"}),ue=A(G,ue,{...b(),class:"m-0"})}),_(l,P)};X(L,l=>{O()&&l(x)})}N(()=>R=A(I,R,{...n(),class:"fixed left-0 top-0 flex items-center gap-1 px-4 py-3"})),_(p,g),oe()}var ze=y('<div> <div class="i-lucide:check h-5 w-5 opacity-0"></div> <span class="text-2.75 ml-auto"> </span></div>'),Be=y("<div></div>"),De=y('<button> <span class="i-lucide:chevron-down transition-property-transform transition"></span></button> <!>',1);function Fe(p,a){ce(a,!0);const i=me(),n=()=>w(O,"$trigger",i),e=()=>w(f,"$menu",i),s=()=>w(U,"$open",i),r=()=>w(V,"$option",i),b=()=>w(F,"$isSelected",i);let v=fe(a,"selected",15);ee(()=>{v()!=null&&Pe(()=>{k.set({value:v()})})});const{elements:{trigger:O,menu:f,option:V},states:{open:U,selected:k},helpers:{isSelected:F}}=ke({forceVisible:!0,positioning:{placement:"bottom",fitViewport:!0,sameWidth:!0}});k.subscribe(g=>{g!=null&&v(g.value)});var K=De(),o=te(K);let h;var S=d(o),C=u(S);q(o,g=>n().action?.(g));var E=u(o,2);{var Z=g=>{var I=Be();let R;re(I,21,()=>a.indexes,ne,(L,x)=>{var l=ze();const P=ae(()=>r()({value:t(x).uid}));let H;var j=d(l),B=u(j);const D=ae(()=>b()(t(x).uid));N(()=>M(B,"opacity-100",t(D)));var W=u(B,2),Q=d(W);q(l,G=>t(P).action?.(G)),N(()=>{H=A(l,H,{class:"data-[highlighted]:bg-#181818 data-[highlighted]:text-red-4 data-[selected]:text-red-4 relative flex cursor-pointer items-center gap-2 p-2",...t(P)}),Y(j,`${t(x).uid??""} `),Y(Q,t(x).count)}),_(L,l)}),q(I,L=>e().action?.(L)),N(()=>R=A(I,R,{class:"bg-#151515 z-10 flex max-h-[300px] flex-col overflow-y-auto focus:!ring-0",...e()})),ie(3,I,()=>se,()=>({duration:150})),_(g,I)};X(E,g=>{s()&&g(Z)})}N(()=>{h=A(o,h,{class:"bg-#151515 b-b-solid b-b-2 b-red-4 flex min-w-[175px] items-center justify-between pl-4 pr-3",...n(),"aria-label":"Select an index"}),Y(S,`${v()??"Select an index"??""} `),M(C,"rotate-180",s())}),_(p,K),oe()}const Re=async(p,a,i,n)=>{if(t(a)==null)return;const e=await m.client.index(t(i)).search(t(n),{page:t(a).page+1});$(a,{...e,hits:[...t(a).hits,...e.hits]})};var He=y('<tr class="not-last:b-b-solid b-b-1 b-b-red-4"><td class="text-3 text-gray-4 w-fit py-1.5 pl-4 text-end"> </td><td class="text-4.5 w-full px-4 py-1.5 font-serif"> </td></tr>'),Ge=y('<table class="not-first:mt-4 bg-#151515 rd-lg w-full"><tbody></tbody></table>'),Je=y('<button class="bg-#151515 b-solid b-1 b-red-4 b-rd-lg mt-4 cursor-pointer p-2 px-4">Load more</button>'),We=y('<div class="mt-4"><span> </span></div> <div class="pb-50px rd-lg mt-4 flex w-full flex-col items-center overflow-y-auto"><!> <!></div>',1),Qe=y('<!> <main class="md:min-w-650px w-100% md:w-65% pt-45vh transition-duration-750ms transition-property-padding relative mx-auto flex h-full min-h-0 flex-col items-center transition"><div class="flex gap-2"><!> <!></div> <!></main> <a target="_blank" rel="noopener" href="https://github.com/beeequeue/mini-meili" class="mt-auto flex shrink-0 items-center justify-center p-1"><div class="i-simple-icons:github mr-1"></div> made by beequeue</a>',1);function Xe(p,a){ce(a,!0),ee(()=>{window.history.pushState({},"",window.location.pathname)});let i=z("");ee(()=>{t(i).length<2||t(e)==null||b(t(i))});let n=z([]),e=z(null);(async()=>{const o=await m.client.getStats();$(n,Object.entries(o.indexes).map(([h,{numberOfDocuments:S}])=>({uid:h,count:S}))),t(n).length===1&&$(e,T(t(n)[0].uid))})();let r=z(null);const b=Ce(async o=>{const h=await m.client.index(t(e)).search(o,{page:1});$(r,h)},250);var v=Qe(),O=te(v);qe(O,{});var f=u(O,2),V=d(f),U=d(V);Fe(U,{get indexes(){return t(n)},get selected(){return t(e)},set selected(o){$(e,T(o))}});var k=u(U,2);le(k,{id:"search",className:"w-300px",placeholder:"Search for something...",get value(){return t(i)},set value(o){$(i,T(o))}});var F=u(V,2);{var K=o=>{var h=We(),S=te(h),C=d(S),E=d(C),Z=u(S,2),g=d(Z);re(g,17,()=>t(r).hits,ne,(L,x)=>{var l=Ge(),P=d(l);re(P,21,()=>Object.keys(t(x)),ne,(H,j)=>{var B=He(),D=d(B),W=d(D),Q=u(D),G=d(Q);N(()=>{Y(W,t(j)),Y(G,t(x)[t(j)])}),_(H,B)}),_(L,l)});var I=u(g,2);{var R=L=>{var x=Je();x.__click=[Re,r,e,i],_(L,x)};X(I,L=>{(t(r).totalPages??0)>(t(r).page??0)&&L(R)})}N(()=>Y(E,`${t(r).estimatedTotalHits??t(r).totalHits??t(r).hits.length??""} hits in
        ${t(r).processingTimeMs??""}ms`)),_(o,h)};X(F,o=>{t(r)!=null&&o(K)})}N(()=>M(f,"pt-50px",(t(r)?.hits.length??0)>0)),_(p,v),oe()}Te(["click"]);Ne(Xe,{target:document.getElementById("root")});
